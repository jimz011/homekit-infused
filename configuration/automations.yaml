# HOMEKIT START DELAY
- alias: Start Homekit
  initial_state: 'true'
  trigger:
  - platform: homeassistant
    event: start
  action:
  - delay: 00:03
  - service: homekit.start


# WHEN SAMSUNG TV TURNS ON, TURN RECEIVER ON  
- alias: Samsung TV Turn ON sony
  initial_state: 'true'
  trigger:
    - entity_id: media_player.samsung_tv_ue65ku6000
      platform: state
      to: 'on'
  action:
    - data:
        entity_id: switch.receiver
      service: switch.turn_on
- alias: Samsung TV Turn OFF sony
  initial_state: 'true'
  trigger:
    - entity_id: media_player.samsung_tv_ue65ku6000
      platform: state
      to: 'off'
  action:
    - data:
        entity_id: switch.receiver
      service: switch.turn_off

# WHEN APPLE TV TURNS ON, TURN ON EVERYTHING
#- alias: APPLE TV Turn ON everything
#  initial_state: 'true'
#  trigger:
#  - entity_id: media_player.woonkamer_apple_tv
#    platform: state
#    from: 'off'
#  action:
#  - data:
#      entity_id: group.samsung_tv
#    service: homeassistant.turn_on
#
#- alias: APPLE TV idle turn off
#  initial_state: 'true'
#  trigger:
#    - entity_id: media_player.woonkamer_apple_tv
#      platform: state
#      to: 'idle'
#      for:
#        seconds: 300
#    - entity_id: media_player.woonkamer_apple_tv
#      platform: state
#      to: 'off'
#  action:
#    - data:
#        entity_id: group.samsung_tv
#      service: homeassistant.turn_off
#    - data:
#        entity_id: media_player.samsung_tv_ue65ku6000
#      service: media_player.turn_off
#    - data:
#        entity_id: switch.samsung_tv
#      service: switch.turn_off

# - alias: Samsung TV off turns on automation
#   initial_state: 'true'
#   trigger:
#   - entity_id: media_player.samsung_tv_ue65ku6000
#     platform: state
#     to: 'off'
#   action:
#   - data:
#       entity_id: automation.apple_tv_idle_turn_off
#     service: automation.turn_on

# WHEN PHILIPS TV TURNS ON, TURN APPLE REMOTE ON  
- alias: Philips TV Turn ON
  initial_state: 'true'
  trigger:
    - entity_id: switch.tv_slaapkamer
      platform: state
      to: 'on'
  action:
    - data:
        entity_id: switch.receiver_slaapkamer
      service: switch.turn_on

# WHEN PHILIPS TV TURNS OFF, TURN APPLE REMOTE OFF  
- alias: Philips TV Turn OFF
  initial_state: 'true'
  trigger:
  - entity_id: switch.tv_slaapkamer
    platform: state
    to: 'off'
  action:
  - data:
      entity_id: switch.receiver_slaapkamer
    service: switch.turn_off

# BADKAMER LAMP IEDERE 10 MINUTEN UIT/AAN
- alias: badkamer_aan_uit
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: switch.koogeek_sw_056ce9
    to: 'on'
    for:
      minutes: 10
  action:
  - service: script.turn_on
    data:
      entity_id: script.badkamer_aanuit

- alias: badkamer_aan_uit_2
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: switch.koogeek_sw_056ce9
    to: 'on'
  action:
  - service: script.turn_off
    data:
      entity_id: script.badkamer_aanuit

# SEND MESSAGE TO IOS AFZUIGKAP ON FOR 30 MIN, BUT ONLY TO 
- alias: Afzuigkap Alert
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: switch.afzuigkap
    to: 'on'
    for:
      minutes: 30
  action:
  - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.ios_notifier
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% endif %}
    data:
      title: "Afzuigkap"
      message: "Ik sta al 30 minuten aan, zou je me niet eens uitzetten?"
      data:
        push:
          sound: default
          badge: 0
          category: "afzuigkap_alert" 
#  - service: xiaomi_aqara.play_ringtone
#    data_template:
#      ringtone_id: 10001
#      ringtone_vol: 100
#      gw_mac: 78:11:DC:DE:F3:24

# DOORS OPEN ALERTS TO IOS
- alias: Voordeur Alert Opened
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.voordeur
    to: 'on'
  action:
  - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.mobile_app_iphone
        {% elif is_state('person.jimmy', 'home') %}
          notify.ios_notifier
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone
        {% endif %}
    data:
      title: "Voordeur"
      message: "De Voordeur is zojuist geopend!"
      data:
        push:
          sound: default

- alias: Voordeur Alert Closed
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.voordeur
    to: 'off'
  action:
  - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.mobile_app_iphone
        {% elif is_state('person.jimmy', 'home') %}
          notify.ios_notifier
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone
        {% endif %}
    data:
      title: "Voordeur"
      message: "De Voordeur is zojuist gesloten!"
      data:
        push:
          sound: default

#
- alias: Woonkamer Deur Alert Opened
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.woonkamer_deur
    to: 'on'
  action:
  - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.nobody
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone
        {% endif %}
    data:
      title: "Woonkamer Deur"
      message: "De Woonkamer Deur is zojuist geopend!"
      data:
        push:
          sound: default

- alias: Woonkamer Alert Closed
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.woonkamer_deur
    to: 'off'
  action:
  - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.nobody
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone
        {% endif %}
    data:
      title: "Woonkamer Deur"
      message: "De Woonkamer Deur is zojuist gesloten!"
      data:
        push:
          sound: default

#
- alias: Slaapkamer Deur Alert Opened
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.slaapkamer_deur
    to: 'on'
  action:
  - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.nobody
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone
        {% endif %}
    data:
      title: "Slaapkamer Deur"
      message: "De Slaapkamer Deur is zojuist geopend!"
      data:
        push:
          sound: default

- alias: Slaapkamer Alert Closed
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.slaapkamer_deur
    to: 'off'
  action:
  - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.nobody
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone
        {% endif %}
    data:
      title: "Slaapkamer Deur"
      message: "De Slaapkamer Deur is zojuist gesloten!"
      data:
        push:
          sound: default
    
# WHEN KEUKENLAMP TURNS ON, TURN KEUKENSPOTS ON (FROM 19.00H-06.00H)
- id: '1533504863293'
  alias: Keukenspotjes aan
  initial_state: 'true'
  trigger:
  - entity_id: light.keuken
    platform: state
    to: 'on'
  condition:
    condition: or
    conditions:
      - after: sunset
        condition: sun
        after_offset: "-01:00:00"
      - before: sunrise
        condition: sun
  action:
  - data:
      entity_id: light.keukenspots
    service: light.turn_on

# WHEN KEUKENLAMP TURNS OFF, BIJKEUKENLAMP TURNS OFF
- alias: keuken_bijkeuken_uit
  initial_state: 'true'
  trigger:
  - entity_id: light.keuken
    from: 'on'
    platform: state
    to: 'off'
  action:
  - service: light.turn_off
    entity_id: light.bijkeuken

# TURN LEDLAMPEN WOONKAMER AND KLEINE KAMER ON AT SUNSET
- alias: leds_aan_at_sunset
  initial_state: 'true'
  trigger:
    platform: sun    
    event: sunset
    offset: '-00:30:00'
  action:
  - data:
      entity_id: light.woonkamer_led_lampen
    service: light.turn_on
  - data:
      entity_id: light.officeled
    service: light.turn_on

# TURN LEDLIGHTS ON/OFF WITH TRADFRI REMOTE, BUT ONLY IF TV IS OFF
- alias: leds_off_button_press
  initial_state: 'true'
  trigger:
    platform: state
    to: 'off'
    entity_id: group.nachtkastjes
  condition:
  - condition: state
    entity_id: switch.tv_slaapkamer  
    state: 'off'
  action:
  - data:
      entity_id: light.slaapkamer_led_lampen
    service: light.turn_off

- alias: leds_on_button_press
  initial_state: 'true'
  trigger:
    platform: state
    to: 'on'
    entity_id: group.nachtkastjes
  condition:
    condition: state
    entity_id: switch.tv_slaapkamer  
    state: 'off'
  action:
  - data:
      entity_id: light.slaapkamer_led_lampen
    service: light.turn_on

# WATERKOKER TURNS ON CAPU MAKER
- alias: waterkoker_cap_on
  initial_state: 'true'
  trigger:
    platform: state
    to: 'on'
    entity_id: switch.waterkoker
  action:
  - data:
      entity_id: switch.cappumaker
    service: switch.turn_on

# WATERKOKER TURNS OFF CAPU MAKER
- alias: waterkoker_cap_off
  initial_state: 'true'
  trigger:
    platform: state
    to: 'off'
    entity_id: switch.waterkoker
  action:
  - data:
      entity_id: switch.cappumaker
    service: switch.turn_off

# TURN ALL LEDS OFF AT SUNRISE
- alias: leds_uit_at_sunrise
  initial_state: 'true'
  trigger:
  - platform: sun
    event: 'sunrise'
  action:
  - data:
      entity_id: light.woonkamer_led_lampen
    service: light.turn_off
  - data:
      entity_id: light.officeled
    service: light.turn_off
  - data:
      entity_id: light.slaapkamer_led_lampen
    service: light.turn_off

# WHEN IPHONEVANJIMMY IS HOME, TURN ON PC VAN JIMMY
- alias: turn_on_jimz_pc
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.jimmy
    to: 'home'
    for:
      seconds: 180
  action:
  - data:
      entity_id: switch.pc_van_jimmy
    service: switch.turn_on

# PC TURNS OFF = XBOX TURNS OFF
- alias: pc_off_xbox_off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: switch.pc_van_jimmy
    to: 'off'
    for:
      seconds: 10
  action:
  - data:
      entity_id: media_player.xbox_one
    service: media_player.turn_off

# WHEN IPHONEVANSTEPH IS HOME, TURN ON PC VAN STEPHANIE
- alias: turn_on_stephanie_pc
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.stephanie
    to: 'home'
    for:
      seconds: 180
  action:
  - data:
      entity_id: switch.pc_van_stephanie
    service: switch.turn_on

# WHEN TOILET MOTION SENSOR TURNS ON, RUN TOILETLAMP_ SCRIPT
- alias: toiletlamp_turn_on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.motion_toilet
    to: 'on'
  condition:
  - condition: time
    after: '06:30:00'
    before: '01:00:00'
  action:
  - data:
      entity_id: script.toiletlamp_1
    service: script.turn_on

# WHEN TOILET MOTION SENSOR TURNS OFF, RUN TOILETLAMP_OFF SCRIPT
- alias: toiletlamp_turn_off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.motion_toilet
    to: 'off'
  action:
  - data:
      entity_id: script.toiletlamp_off
    service: script.turn_on

# WHEN TOILET @ NIGHT MOTION SENSOR TURNS ON, RUN TOILETLAMP SCRIPT
- alias: toiletlamp_turn_on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.motion_toilet
    to: 'on'
  condition:
  - condition: time
    after: '01:00:00'
    before: '06:30:00'
  action:
  - data:
      entity_id: script.toiletlamp_1_night
    service: script.turn_on

# WHEN BIJKEUKEN MOTION SENSOR TURNS ON, RUN BIJKEUKENLAMP SCRIPT
- alias: bijkeukenlamp_turn_on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.motion_bijkeuken
    to: 'on'
  action:
  - data:
      entity_id: script.bijkeukenlamp
    service: script.turn_on

# WHEN BIJKEUKEN MOTION SENSOR TURNS OFF, RUN BIJKEUKENLAMP_OFF SCRIPT
- alias: bijkeukenlamp_turn_off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.motion_bijkeuken
    to: 'off'
  action:
  - data:
      entity_id: script.bijkeukenlamp_off
    service: script.turn_on

######################################################################
### MANUAL ALARM PANEL                                             ###
######################################################################

# ALARM FOR AWAY
- alias: Alarm Away
  initial_state: 'true'
  hide_entity: True
  trigger:
  - entity_id: binary_sensor.voordeur
    platform: state
    to: 'on'
  - entity_id: binary_sensor.slaapkamer_deur
    platform: state
    to: 'on'
  - entity_id: binary_sensor.woonkamer_deur
    platform: state
    to: 'on'
  - entity_id: binary_sensor.motion_toilet
    platform: state
    to: 'on'
  - entity_id: binary_sensor.motion_bijkeuken
    platform: state
    to: 'on'
  condition:
  - entity_id: alarm_control_panel.home_alarm
    state: 'armed_away'
    condition: state
  action:
  - data:
      entity_id: alarm_control_panel.home_alarm
    service: alarm_control_panel.alarm_trigger

# ALARM FOR AT HOME
- alias: Alarm Home
  initial_state: 'true'
  hide_entity: True
  trigger:
  - entity_id: binary_sensor.voordeur
    platform: state
    to: 'on'
  - entity_id: binary_sensor.slaapkamer_deur
    platform: state
    to: 'on'
  - entity_id: binary_sensor.woonkamer_deur
    platform: state
    to: 'on'
  condition:
  - entity_id: alarm_control_panel.home_alarm
    state: 'armed_home'
    condition: state
  action:
  - data:
      entity_id: alarm_control_panel.home_alarm
    service: alarm_control_panel.alarm_trigger

# ALARM FOR AT NIGHT
- alias: Alarm Night
  initial_state: 'true'
  hide_entity: True
  trigger:
  - entity_id: binary_sensor.voordeur
    platform: state
    to: 'on'
  condition:
  - entity_id: alarm_control_panel.home_alarm
    state: 'armed_night'
    condition: state
  action:
  - data:
      entity_id: alarm_control_panel.home_alarm
    service: alarm_control_panel.alarm_trigger

################################################################
### ALARM TRIGGERS                                             #
################################################################
- alias: Triggered Flash
  initial_state: 'true'
  hide_entity: True
  trigger:
  - entity_id: alarm_control_panel.home_alarm
    platform: state
    to: 'triggered'
  action:
  - data:
      entity_id: script.light_flash
    service: script.turn_on
  - data:
      entity_id: script.xiaomi_alarm_siren
    service: script.turn_on

################################################################
### ALARM DISARMED                                             #
################################################################
- alias: Disarmed Off
  initial_state: 'true'
  hide_entity: True
  trigger:
  - entity_id: alarm_control_panel.home_alarm
    platform: state
    to: 'disarmed'
  action:
  - data:
      entity_id: script.light_flash
    service: script.turn_off
  - data:
      entity_id: script.xiaomi_alarm_siren
    service: script.turn_off
  - data:
      entity_id: script.xiaomi_alarm_siren_loop
    service: script.turn_off
#  - data:
#      entity_id: script.all_lights_turn_on
#    service: script.turn_on

- alias: Alarm Alert
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: alarm_control_panel.home_alarm
    to: 'triggered'
  action:
  - service: notify.ios_notifier
    data:
      title: "Home Alarm"
      message: "ALARM ALARM !Het Alarm is afgegaan! ALARM ALARM"
      data:
        push:
          sound: default
          badge: 0
          category: "alarm_alert"

- alias: Alarm Away Notification
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: alarm_control_panel.home_alarm
    to: 'armed_away'
  action:
  - service: notify.ios_notifier
    data:
      title: "Home Alarm"
      message: "Het Alarm is ingeschakeld voor Afwezig!"
      data:
        push:
          sound: default 

- alias: Alarm Home Notification
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: alarm_control_panel.home_alarm
    to: 'armed_home'
  action:
  - service: notify.ios_notifier
    data:
      title: "Home Alarm"
      message: "Het Alarm is ingeschakeld voor Thuis!"
      data:
        push:
          sound: default

- alias: Alarm Night Notification
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: alarm_control_panel.home_alarm
    to: 'armed_night'
  action:
  - service: notify.ios_notifier
    data:
      title: "Home Alarm"
      message: "Het Alarm is ingeschakeld voor de Nacht!"
      data:
        push:
          sound: default

- alias: Alarm Disarm Notification
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: alarm_control_panel.home_alarm
    to: 'disarmed'
  action:
  - service: notify.ios_notifier
    data:
      title: "Home Alarm"
      message: "Het Alarm is uitgeschakeld!"  
      data:
        push:
          sound: default

# LEAVE HOME AT NIGHTTIME
- alias: tot ziens avond
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.device_status
    from: 'home'
  condition:
    condition: or
    conditions:
      - after: sunset
        condition: sun
        after_offset: "-01:00:00"
      - before: sunrise
        condition: sun
  action:
  - service: scene.turn_on
    entity_id: scene.tot_ziens_avond

# LEAVE HOME AT DAYTIME
- alias: tot ziens overdag
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.device_status
    from: 'home'
  condition:
    condition: or
    conditions:
      - after: sunrise
        condition: sun
      - before: sunset
        condition: sun
        before_offset: "-01:00:00"
  action:
  - service: scene.turn_on
    entity_id: scene.tot_ziens_overdag

# ARRIVE HOME WITH DAY SCENE
- alias: welkom overdag
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.device_status
    to: 'home'
    for:
      seconds: 90
  condition:
    condition: or
    conditions:
      - after: sunrise
        condition: sun
      - before: sunset
        condition: sun
        before_offset: "-01:00:00"
  action:
  - service: scene.turn_on
    entity_id: scene.dagverlichting

# ARRIVE HOME WITH NIGHT SCENE
- alias: welkom avond
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.device_status
    to: 'home'
    for:
      seconds: 90
  condition:
    condition: or
    conditions:
      - after: sunset
        condition: sun
        after_offset: "-01:00:00"
      - before: sunrise
        condition: sun
  action:
  - service: scene.turn_on
    entity_id: scene.nachtverlichting

# ARRIVE HOME WITH NIGHT SCENE ENTREE
- alias: welkom avond entree
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.voordeur
    to: 'on'
    from: 'off'
  condition:
    condition: or
    conditions:
      - after: sunset
        condition: sun
        after_offset: "-01:00:00"
      - before: sunrise
        condition: sun
  action:
  - service: light.turn_on
    entity_id: light.entree_lamp


- alias: deur dicht lichten uit
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.voordeur
    to: 'off'
    from: 'on'
  action:
  - delay:
      seconds: 20
  - service: light.turn_off
    entity_id: light.entree_lamp
  - service: light.turn_off
    entity_id: light.gang_lamp

- alias: turn_off_automation_light
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: binary_sensor.voordeur
    to: 'on'
    from: 'off'
  action:
  - delay:
      seconds: 10
  - entity_id: automation.welkom_avond_entree
    service: automation.turn_off

- alias: turn_on_automation_light
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.jimmy
    to: 'home'
  - platform: state
    entity_id: person.stephanie
    to: 'home'
  action:
  - entity_id: automation.welkom_avond_entree
    service: automation.turn_on


# TURN SLAAPKAMER LEDLAMPEN ON AT SUNSET IF NOBODY IS HOME
- alias: leds_if_not_home
  initial_state: 'true'
  trigger:
  - platform: sun
    event: sunset
    offset: "-00:30:00"
  condition:
  - condition: state
    entity_id: group.device_status
    state: not_home
  action:
  - data:
      entity_id: light.slaapkamer_led_lampen
    service: light.turn_on

# TURN ON BEDROOM LEDS WHEN TOILETLAMP IS ON AT NIGHT
- alias: toiletlamp is vloerled
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: light.toiletlamp
    to: 'on'
  condition:
    condition: and
    conditions:
      - condition: time
        before: '08:00:00'
        after: '00:00:00'
      - condition: state
        entity_id: switch.pc_van_jimmy
        state: 'off'
  action:
  - data:
      entity_id: script.slaapkamer_vloer_led
    service: script.turn_on
    

# Alarm Notifications/Automatic Disarm
- alias: Alarm Disarm Jimmy Away
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.jimmy
    to: 'home'
    for:
      seconds: 30
  condition:
    - condition: state
      entity_id: alarm_control_panel.home_alarm  
      state: 'armed_away'
  action:
    - service: alarm_control_panel.alarm_disarm
      data: !secret alarmcode   

- alias: Alarm Disarm Jimmy Home
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.jimmy
    to: 'home'
    for:
      seconds: 30
  condition:
    - condition: state
      entity_id: alarm_control_panel.home_alarm  
      state: 'armed_home'
  action:
    - service: alarm_control_panel.alarm_disarm
      data: !secret alarmcode  

- alias: Alarm Disarm Steph Away
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.stephanie
    to: 'home'
    for:
      seconds: 30
  condition:
    - condition: state
      entity_id: alarm_control_panel.home_alarm  
      state: 'armed_away'
  action:
    - service: alarm_control_panel.alarm_disarm
      data: !secret alarmcode  

- alias: Alarm Disarm Steph Home
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.stephanie
    to: 'home'
    for:
      seconds: 30
  condition:
    - condition: state
      entity_id: alarm_control_panel.home_alarm  
      state: 'armed_home'
  action:
    - service: alarm_control_panel.alarm_disarm
      data: !secret alarmcode  

- alias: Alarm Activation Alert
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.device_status_3
    from: 'home'
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: alarm_control_panel.home_alarm  
        state: 'disarmed'
      - condition: state
        entity_id: alarm_control_panel.home_alarm  
        state: 'armed_home'
  action:
    - service: alarm_control_panel.alarm_arm_away
      data: !secret alarmcode  

- alias: Alarm Activation Dog Home
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.device_status
    from: 'home'
  condition:
    - condition: state
      entity_id: alarm_control_panel.home_alarm  
      state: 'disarmed'
  action:
    - service: alarm_control_panel.alarm_arm_home
      data: !secret alarmcode 

#simple alarm automations
- alias: simple alarm activate
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_boolean.simple_alarm
    to: 'on'
  action:
    - service: alarm_control_panel.alarm_arm_home
      data: !secret alarmcode 
- alias: simple alarm deactivate
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_boolean.simple_alarm
    to: 'off'
  action:
    - service: alarm_control_panel.alarm_disarm
      data: !secret alarmcode 

# Notify Jimmy/Stephanie when arrive home
- alias: Jimmy Home Alert
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.jimmy
    from: 'not_home'
    to: 'home'
    for:
      seconds: 60
  action:
  - service: notify.mobile_app_iphone_stephanie
    data:
      title: "Locatie"
      message: "Jimmy is zojuist Thuis gearriveerd"
      data:
        push:
          sound: default
          category: map
        action_data:
          latitude: !secret latitude1
          longitude: !secret longitude1

- alias: Stephanie Home Alert
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: person.stephanie
    to: 'home'
    for:
      seconds: 60
  action:
  - service: notify.mobile_app_iphone
    data:
      title: "Locatie"
      message: "Stephanie is zojuist Thuis gearriveerd"
      data:
        push:
          badge: 0
          sound: default
          category: map
        action_data:
          latitude: !secret latitude1
          longitude: !secret longitude1

# Changed/Added in 0.13.0 below
# Set theme on startup
- alias: 'Set theme light at startup'
  initial_state: 'true'
  trigger:
    - platform: homeassistant
      event: start
  condition:
    condition: state
    entity_id: sun.sun
    state: 'above_horizon'
  action:
    service: frontend.set_theme
    data:
      name: Silver

- alias: 'Set theme dark at startup'
  initial_state: 'true'
  trigger:
    - platform: homeassistant
      event: start
  condition:
    condition: state
    entity_id: sun.sun
    state: 'below_horizon'
  action:
    - service: frontend.set_theme
      data:
        name: Space Gray
# Theme Selector Automations
- alias: 'theme selector input_select 1'
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_select.theme_selector
      to: 'Silver'
  action:
    - service: frontend.set_theme
      data:
        name: Silver
    - service: homeassistant.turn_off
      data:
        entity_id: group.theme_selector
- alias: 'theme selector input_select 2'
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_select.theme_selector
      to: 'Space Gray'
  action:
    - service: frontend.set_theme
      data:
        name: Space Gray
    - service: homeassistant.turn_off
      data:
        entity_id: group.theme_selector
- alias: 'theme selector input_select 3'
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_select.theme_selector
      to: 'Sweet Pink'
  action:
    - service: frontend.set_theme
      data:
        name: Sweet Pink
    - service: homeassistant.turn_off
      data:
        entity_id: group.theme_selector
# - alias: 'theme selector input_select 4'
#   initial_state: true
#   trigger:
#     - platform: state
#       entity_id: input_select.theme_selector
#       to: 'Red'
#   action:
#     - service: frontend.set_theme
#       data:
#         name: Red
#     - service: homeassistant.turn_off
#       data:
#         entity_id: group.theme_selector
# - alias: 'theme selector input_select 5'
#   initial_state: true
#   trigger:
#     - platform: state
#       entity_id: input_select.theme_selector
#       to: 'Blue Light'
#   action:
#     - service: frontend.set_theme
#       data:
#         name: Blue Light
#     - service: homeassistant.turn_off
#       data:
#         entity_id: group.theme_selector
# - alias: 'theme selector input_select 6'
#   initial_state: true
#   trigger:
#     - platform: state
#       entity_id: input_select.theme_selector
#       to: 'Blue Dark'
#   action:
#     - service: frontend.set_theme
#       data:
#         name: Blue Dark
#     - service: homeassistant.turn_off
#       data:
#         entity_id: group.theme_selector
- alias: 'theme selector input_select 7'
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_select.theme_selector
      to: 'Auto (default)'
  action:
    - service: frontend.set_theme
      data:
        name: Space Gray
    - service: homeassistant.turn_on
      data:
        entity_id: group.theme_selector
- alias: 'theme selector input_select 10'
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_select.theme_selector
      to: 'Disable'
  action:
    - service: frontend.set_theme
      data:
        name: Disable
    - service: homeassistant.turn_off
      data:
        entity_id: group.theme_selector

# Theme Day/Night Cycle
- alias: 'Set dark theme for the night'
  initial_state: true
  trigger:
    - platform: sun
      event: sunset
      offset: '+00:00:00'
  action:
    - service: frontend.set_theme
      data:
        name: Space Gray
- alias: 'Set light theme for the day'
  initial_state: true
  trigger:
    - platform: sun
      event: sunrise
      offset: '+00:00:00'
  action:
    - service: frontend.set_theme
      data:
        name: Silver
# Changed/Added in 0.13.0 Above

# 
#################################################################################
#        Wasmachine, Droger en Vaatwasser Automations                           #
#################################################################################
 
# When we detect power being drawn from the vaatwasser,
# mark the vaatwasser as using power
 
- alias: Set vaatwasser active when power detected
  initial_state: 'true'
  trigger:
    - platform: numeric_state
      entity_id: sensor.vaatwasser_energy_power
      above: 10
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_select.vaatwasser_status
        state: Idle
      - condition: state
        entity_id: input_select.vaatwasser_status
        state: Clean
      - condition: state
        entity_id: input_select.vaatwasser_status
        state: Drying
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.vaatwasser_status
        option: Running
 
# When the power level drops below 10, and the vaatwasser is set to
# the 'Running' state, mark the vaatwasser as Finished
 
- alias: Set vaatwasser drying when power drops
  initial_state: 'true'
  trigger:
    - platform: numeric_state
      entity_id: sensor.vaatwasser_energy_power
      below: 10
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.vaatwasser_status
        state: Running
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.vaatwasser_status
        option: Drying
 
# Once the vaatwasser status has been 'Drying' for 30 minutes, mark the
# vaatwasser as clean
 
- alias: Set vaatwasser clean
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: input_select.vaatwasser_status
      to: Drying
      for:
        minutes: 15
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.vaatwasser_status
        state: Drying
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.vaatwasser_status
        option: Clean
 
# When the power drops and the vaatwasser is Clean or Drying, someone has
# turned the vaatwasser off and emptied it. We should do this when the state
# of the vaatwasser is clean or Finishing, just incase someone opens the
# vaatwasser before the 30 minute timeout has been reached.
 
- alias: Set vaatwasser dirty when power off
  initial_state: 'true'
  trigger:
    - platform: numeric_state
      entity_id: sensor.vaatwasser_energy_power
      below: 1
  condition:
    condition: and
    conditions:
      - condition: numeric_state
        entity_id: sensor.vaatwasser_energy_power
        below: 1
      - condition: or
        conditions:
        - condition: state
          entity_id: input_select.vaatwasser_status
          state: Clean
        - condition: state
          entity_id: input_select.vaatwasser_status
          state: Drying
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.vaatwasser_status
        option: Idle
 
# When power is detected, and the washing machine is not in 
# the Running state, change the status of the washing machine
# to Running. 
# The status check will ensure we don't try to put the state 
# to Running each time the power level changes, and we're already
# in the Running state.
 
- alias: Set washing machine active when power detected
  initial_state: 'true'
  trigger:
    - platform: numeric_state
      entity_id: sensor.wasmachine_energy_power
      above: 10
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_select.wasmachine_status
        state: Idle
      - condition: state
        entity_id: input_select.wasmachine_status
        state: Clean
      - condition: state
        entity_id: input_select.wasmachine_status
        state: Finishing
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.wasmachine_status
        option: Running
 
# When the power drops, move the state of the washing machine to 
# Finishing.
 
- alias: Set washing machine finished when power drops
  initial_state: 'true'
  trigger:
    - platform: numeric_state
      entity_id: sensor.wasmachine_energy_power
      below: 6
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.wasmachine_status
        state: Running
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.wasmachine_status
        option: Finishing
 
# Wait 8 minutes for us to be in the Finishing state before we
# decide the washing machine has finished. This way, if the 
# washing machine is in between cycles and the power drops, we 
# won't mark the washing machine cycle as finished too early.
 
- alias: Set washing machine clean after timeout
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: input_select.wasmachine_status
      to: Finishing
      for:
        minutes: 8
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.wasmachine_status
        state: Finishing
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.wasmachine_status
        option: Clean
 
- alias: Set vaatwasser to POWER OFF when power is OFF
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: switch.vaatwasser
      to: 'off'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.vaatwasser_status
        option: Power OFF

- alias: Set vaatwasser to idle when powered ON
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: switch.vaatwasser
      to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.vaatwasser_status
        state: Power OFF
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.vaatwasser_status
        option: Idle

- alias: Set washing machine dirty when door opens
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: switch.wasmachine
      to: 'off'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.wasmachine_status
        option: Power OFF

- alias: Set washingmachine to POWER OFF when powered off
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: switch.wasmachine
      to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.wasmachine_status
        state: Power OFF
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.wasmachine_status
        option: Idle
 
- alias: Set droger active when power detected
  initial_state: 'true'
  trigger:
    - platform: numeric_state
      entity_id: sensor.droger_energy_power
      above: 10
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_select.droger_status
        state: Idle
      - condition: state
        entity_id: input_select.droger_status
        state: Clean
      - condition: state
        entity_id: input_select.droger_status
        state: Finishing
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.droger_status
        option: Running
 
- alias: Set washing machine finished when power drops
  initial_state: 'true'
  trigger:
    - platform: numeric_state
      entity_id: sensor.droger_energy_power
      below: 6
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.droger_status
        state: Running
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.droger_status
        option: Finishing

- alias: Set droger clean after timeout
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: input_select.droger_status
      to: Finishing
      for:
        minutes: 2
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.droger_status
        state: Finishing
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.droger_status
        option: Clean

- alias: Set droger to POWER OFF when turned OFF
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: switch.droger
      to: 'off'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.droger_status
        option: Power OFF

- alias: Set droger idle when turned on
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: switch.droger
      to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.droger_status
        state: Power OFF
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.droger_status
        option: Idle

# Vaatwasser Gereed Notificatie
- alias: Send alert when vaatwasser is clean
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: input_select.vaatwasser_status
      to: Clean
    - platform: state
      entity_id: person.jimmy
      to: 'home'
      for:
        minutes: 3
    - platform: state
      entity_id: person.stephanie
      to: 'home'
      for:
        minutes: 3
  condition:
    condition: and
    conditions:
      - condition: time
        before: '22:30:00'
        after: '08:29:00'
      - condition: state
        entity_id: group.device_status
        state: 'home'
      - condition: state
        entity_id: input_select.vaatwasser_status
        state: Clean
      # Don't send this alert if it was last triggered less than 30 minutes ago (1,800 seconds)
      - condition: template
        value_template: >
          {% if states.automation.send_alert_when_vaatwasser_is_clean.last_triggered is not none %}
            {% if as_timestamp(now()) | int   -  as_timestamp(states.automation.send_alert_when_vaatwasser_is_clean.attributes.last_triggered) | int > 3600 %} true {% else %} false
            {% endif %}
          {% else %}
          false
          {% endif %}
  action:
    - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.ios_notifier
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% endif %}
      data:
        message: 'De Vaatwasser heeft zijn programma voltooid en kan leeggemaakt worden!'
        title: 'Vaatwasser'
        data:
          push:
            badge: 0
            sound: default
            category: "vaatwasser_alert"
#    - service: xiaomi_aqara.play_ringtone
#      data_template:
#        ringtone_id: 10002
#        ringtone_vol: 100
#        gw_mac: 78:11:DC:DE:F3:24

# Wasmachine Gereed Notificatie
- alias: Send alert when washing machine is finished
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.wasmachine_status
      to: Clean
      for:
        minutes: 1
    - platform: state
      entity_id: person.jimmy
      to: 'home'
      for:
        minutes: 3
    - platform: state
      entity_id: person.stephanie
      to: 'home'
      for:
        minutes: 3
  condition:
    condition: and
    conditions:
      - condition: time
        before: '01:30:00'
        after: '08:30:00'
      - condition: state
        entity_id: group.device_status
        state: 'home'
      - condition: state
        entity_id: input_select.wasmachine_status
        state: Clean
      - condition: template
        value_template: >
          {% if states.automation.send_alert_when_wasmachine_is_finished.last_triggered is not none %}
            {% if as_timestamp(now()) | int   -  as_timestamp(states.automation.send_alert_when_wasmachine_is_finished.attributes.last_triggered) | int > 1800 %} true {% else %} false
            {% endif %}
          {% else %}
          false
          {% endif %}
  action:
    - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.ios_notifier
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% endif %}
      data:
        message: 'De Wasmachine heeft zijn programma voltooid en kan leeggemaakt worden!'
        title: 'Wasmachine'
        data:
          push:
            badge: 0
            sound: default
            category: "wasmachine_alert" 
#    - service: xiaomi_aqara.play_ringtone
#      data_template:
#        ringtone_id: 10005
#        ringtone_vol: 100
#        gw_mac: 78:11:DC:DE:F3:24

# Droger Gereed Notificatie
- alias: Send alert when droger is finished
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.droger_status
      to: Clean
      for:
        minutes: 1
    - platform: state
      entity_id: person.jimmy
      to: 'home'
      for:
        minutes: 3
    - platform: state
      entity_id: person.stephanie
      to: 'home'
      for:
        minutes: 3
  condition:
    condition: and
    conditions:
      - condition: time
        before: '01:30:00'
        after: '08:30:00'
      - condition: state
        entity_id: group.device_status
        state: 'home'
      - condition: state
        entity_id: input_select.droger_status
        state: Clean
      - condition: template
        value_template: >
          {% if states.automation.send_alert_when_droger_is_finished.last_triggered is not none %}
            {% if as_timestamp(now()) | int   -  as_timestamp(states.automation.send_alert_when_droger_is_finished.attributes.last_triggered) | int > 1800 %} true {% else %} false
            {% endif %}
          {% else %}
          false
          {% endif %}
  action:
    - service_template: >
        {% if (is_state('person.jimmy', 'home')) and (is_state('person.stephanie', 'home'))  %}
          notify.ios_notifier
        {% elif is_state('person.jimmy', 'home') %}
          notify.mobile_app_iphone
        {% elif is_state('person.stephanie', 'home') %}
          notify.mobile_app_iphone_stephanie
        {% endif %}
      data:
        message: 'De Droger heeft zijn programma voltooid en kan leeggemaakt worden!'
        title: 'Droger'
        data:
          push:
            badge: 0
            sound: default
            category: "droger_alert" 
#    - service: xiaomi_aqara.play_ringtone
#      data_template:
#        ringtone_id: 10003
#        ringtone_vol: 100
#        gw_mac: 78:11:DC:DE:F3:24

# Motion Detection Notificaties / Camera
- alias: Motion detected no one home bijkeuken
  initial_state: 'true'
  trigger:
  - entity_id: binary_sensor.motion_bijkeuken
    platform: state
    to: 'on'
  condition:
  - entity_id: group.device_status
    state: 'not_home'
    condition: state
  action:
  - service: notify.ios_notifier
    data:
      message: 'Er is beweging gedetecteerd in de bijkeuken terwijl er niemand thuis is! Wat wil je doen?'
      title: 'Motion'
      data:
        push:
          badge: 0
          sound: default
          category: "bijkeuken_alert"

- alias: Motion detected no one home toilet
  initial_state: 'true'
  trigger:
  - entity_id: binary_sensor.motion_toilet
    platform: state
    to: 'on'
  condition:
  - entity_id: group.device_status
    state: 'not_home'
    condition: state
  action:
  - service: notify.ios_notifier
    data:
      message: 'Er is beweging gedetecteerd in het toilet terwijl er niemand thuis is! Wat wil je doen? '
      title: 'Motion'
      data:
        push:
          badge: 0
          sound: default
          category: "toilet_alert" 

- alias: Motion detected no one home gallerij
  initial_state: 'false'
  trigger:
  - entity_id: binary_sensor.dafang_motion_sensor
    platform: state
    to: 'on'
  condition:
  - entity_id: group.device_status
    state: 'not_home'
    condition: state
  action:
  - service: notify.ios_notifier
    data:
      message: 'Er is beweging gedetecteerd op de gallerij! '
      title: 'Motion'
      data:
        attachment:
          content-type: jpeg
        push:
          badge: 0
          sound: default
          category: camera 
        entity_id: camera.gallerij_camera

# Actionable Notifications voor iOS
- alias: iOS Actionable Notification for Afzuigkap
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: AFZUIGKAP_UITZETTEN
  action:
    service: switch.turn_off
    entity_id: switch.afzuigkap

- alias: iOS Actionable Notification for Bijkeuken
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: THUIS_ALARM
  action:
    service: alarm_control_panel.alarm_arm_home
    data: !secret alarmcode

- alias: iOS Actionable Notification for Toilet
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: AFWEZIG_ALARM
  action:
    service: alarm_control_panel.alarm_arm_away
    data: !secret alarmcode

- alias: iOS Actionable Notification for Droger_1
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: VAATWASSER_INSCHAKELEN
  action:
    service: switch.turn_on
    entity_id: switch.vaatwasser

- alias: iOS Actionable Notification for Droger_2
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: DROGER_UITSCHAKELEN
  action:
    service: switch.turn_off
    entity_id: switch.droger

- alias: iOS Actionable Notification for Wasmachine_1
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: VAATWASSER_INSCHAKELEN
  action:
    service: switch.turn_on
    entity_id: switch.vaatwasser

- alias: iOS Actionable Notification for Wasmachine_2
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: WASMACHINE_UITSCHAKELEN
  action:
    service: switch.turn_off
    entity_id: switch.wasmachine

- alias: iOS Actionable Notification for Vaatwasser_1
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: VAATWASSER_UITSCHAKELEN
  action:
    service: switch.turn_off
    entity_id: switch.vaatwasser

- alias: iOS Actionable Notification for Alarm Afwezig
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: ALARM_AFWEZIG
  action:
    service: alarm_control_panel.alarm_arm_away
    data: !secret alarmcode

- alias: iOS Actionable Notification for Alarm Thuis
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: ALARM_THUIS
  action:
    service: alarm_control_panel.alarm_arm_home
    data: !secret alarmcode

- alias: iOS Actionable Notification for Smoke
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: SMOKE_UITSCHAKELEN
  action:
    service: homeassistant.turn_off
    entity_id: binary_sensor.lumi_sensor_smoke
    
- alias: iOS Actionable Notification for Alarm
  initial_state: 'true'
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: ALARM_UITSCHAKELEN
  action:
    service: alarm_control_panel.alarm_disarm
    data: !secret alarmcode

# Dimmen/Verlichten bij film kijken
  # Woonkamer
- alias: "Media player paused/stopped"
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id:  media_player.woonkamer_apple_tv
      from: 'playing'
  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
  action:
      service: scene.turn_on
      entity_id: scene.living_dim_2

- alias: "Media player playing"
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id:  media_player.woonkamer_apple_tv
      to: 'playing'
  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
  action:
      service: scene.turn_on
      entity_id: scene.living_movie
  # Slaapkamer
- alias: "Media player paused/stopped bedroom"
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id:  media_player.slaapkamer_apple_tv
      from: 'playing'
  condition:
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'
  action:
      service: scene.turn_on
      entity_id: scene.slaapkamer_dim

- alias: "Media player playing bedroom"
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id:  media_player.slaapkamer_apple_tv
      to: 'playing'
  action:
      service: scene.turn_on
      entity_id: scene.slaapkamer_movie

- alias: APK date expiration notification Peugeot
  initial_state: 'true'
  trigger:
    - platform: template
      value_template: "{{ ((as_timestamp(strptime(states('sensor.peugeot_207_expdate'), '%d %b %Y')) / 86400) | int) == ((as_timestamp(strptime(states('sensor.date'), '%Y-%m-%d')) / 86400) | int) + 21 }} }}"
  action:
    - service: notify.mobile_app_iphone
      data_template:
        title: 'APK Peugeot 207 SW'
        message: De APK op uw Peugeot 207 SW met kenteken 21-XX-DL verloopt op {{ states.sensor.peugeot_207_expdate.state }}. Plan een keuring bij uw garage.
        data:
          push:
            sound: default
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.apkjimz

- alias: APK date expiration notification Citroen
  initial_state: 'true'
  trigger:
    - platform: template
      value_template: "{{ ((as_timestamp(strptime(states('sensor.citroen_c1_expdate'), '%d %b %Y')) / 86400) | int) == ((as_timestamp(strptime(states('sensor.date'), '%Y-%m-%d')) / 86400) | int) + 21 }} }}"
  action:
    - service: notify.mobile_app_iphone_stephanie
      data_template:
        title: 'APK Citron C1'
        message: De APK op uw Citron C1 met kenteken 55-GFF-3 verloopt op {{ states.sensor.citroen_c1_expdate.state }}. Plan een keuring bij uw garage.
        data:
          push:
            sound: default
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.apksteph

- alias: APK Peugeot Boolean Reset
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.peugeot_207_expdate
  action:
    - service: input_boolean.turn_off
      data:
        entity_id: input_boolean.apkjimz
- alias: APK Citroen Boolean Reset
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.citroen_c1_expdate
  action:
    - service: input_boolean.turn_off
      data:
        entity_id: input_boolean.apksteph

# Rookmelder
- alias: Smoke Alert
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: binary_sensor.lumi_sensor_smoke
      to: 'on'
  action:
    - service: notify.ios_notifier
      data:
        title: "Rookmelder"
        message: "Attentie, Er is rook gesignaleerd in de Keuken, onderneem nu actie!"
        data:
          push:
            sound: default
            badge: 0
            category: "smoke_alert"

# Vaatwasser starten na een wasprogramma
- alias: Vaatwasser Starten na Drogen
  initial_state: 'false'
  trigger:
    - platform: state
      entity_id: sensor.droger_status
      to: Clean
      for:
        minutes: 20
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: switch.vaatwasser
        state: 'on'
  action:
    - service: switch.turn_off
      data:
        entity_id: switch.droger
    - service: switch.turn_on
      data:
        entity_id: switch.vaatwasser

- alias: Vaatwasser Starten na Wassen
  initial_state: 'false'
  trigger:
    - platform: state
      entity_id: sensor.wasmachine_status
      to: Clean
      for:
        minutes: 20
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: switch.vaatwasser
        state: 'on'
  action:
    - service: switch.turn_off
      data:
        entity_id: switch.wasmachine
    - service: switch.turn_on
      data:
        entity_id: switch.vaatwasser

# Medicijnen Stephanie Notificatie
- alias: Start notify script Stephanie
  initial_state: 'true'
  trigger:
    - platform: time
      at: '22:00:00'
  action:
    - service: script.turn_on
      data:
        entity_id: script.stephnotification

- alias: iOS Actionable Notification for meds alert
  trigger:
    platform: event
    event_type: ios.notification_action_fired
    event_data:
      actionName: MEDS_ALARM
  action:
    service: script.turn_off
    entity_id: script.stephnotification

- alias: 'Update Available Notifications'
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: updater.updater
  action:
  - service: notify.mobile_app_iphone
    data:
      title: 'Home Assistant Update'
      message: 'Er is een update voor Home Assistant uitgebracht. HA Versie {{ states.updater.updater.state }}.'
      data:
        push:
          sound: default

# Tado Heating
- alias: set tado woonkamer heat
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_boolean.tado_woonkamer
    to: 'on'
  action:
  - service: climate.set_hvac_mode
    data:
      entity_id: climate.tado_smart_radiator_thermostat_va2898201344
      hvac_mode: heat
- alias: set tado woonkamer off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_boolean.tado_woonkamer
    to: 'off'
  action:
  - service: climate.set_hvac_mode
    data:
      entity_id: climate.tado_smart_radiator_thermostat_va2898201344
      hvac_mode: "off"

- alias: set tado woonkamer heat other methods
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: climate.tado_smart_radiator_thermostat_va2898201344
    to: 'heat'
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.tado_woonkamer
- alias: set tado woonkamer off other methods
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: climate.tado_smart_radiator_thermostat_va2898201344
    to: 'off'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.tado_woonkamer

- alias: set tado kleine kamer heat
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_boolean.tado_kleine_kamer
    to: 'on'
  action:
  - service: climate.set_hvac_mode
    data:
      entity_id: climate.tado_smart_radiator_thermostat_va1671957504
      hvac_mode: heat
- alias: set tado kleine kamer off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_boolean.tado_kleine_kamer
    to: 'off'
  action:
  - service: climate.set_hvac_mode
    data:
      entity_id: climate.tado_smart_radiator_thermostat_va1671957504
      hvac_mode: "off"
      
- alias: set tado kleine kamer heat other methods
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: climate.tado_smart_radiator_thermostat_va1671957504
    to: 'heat'
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.tado_kleine_kamer
- alias: set tado kleine kamer off other methods
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: climate.tado_smart_radiator_thermostat_va1671957504
    to: 'off'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.tado_kleine_kamer
      
## Scenes Input Booleans (Work in Progress)
- alias: scene dagverlichting on
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: group.scene_dagverlichting_on
      to: 'on'
    - platform: state
      entity_id: group.scene_dagverlichting_off
      to: 'off'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: group.scene_dagverlichting_off
        state: 'off'
      - condition: state
        entity_id: group.scene_dagverlichting_on
        state: 'on'
  action:
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.scene_dagverlichting
      
- alias: scene dagverlichting off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_dagverlichting_on
    to: 'off'
  - platform: state
    entity_id: group.scene_dagverlichting_off
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_dagverlichting
      
- alias: scene nachtverlichting on
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: group.scene_nachtverlichting_on
      to: 'on'
    - platform: state
      entity_id: group.scene_nachtverlichting_off
      to: 'off'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: group.scene_nachtverlichting_off
        state: 'off'
      - condition: state
        entity_id: group.scene_nachtverlichting_on
        state: 'on'
  action:
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.scene_nachtverlichting
      
- alias: scene nachtverlichting off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_nachtverlichting_on
    to: 'off'
  - platform: state
    entity_id: group.scene_nachtverlichting_off
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_nachtverlichting
      
- alias: scene avondverlichting on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_avondverlichting_on
    to: 'on'
  - platform: state
    entity_id: group.scene_avondverlichting_off
    to: 'off'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: group.scene_avondverlichting_off
        state: 'off'
      - condition: state
        entity_id: group.scene_avondverlichting_on
        state: 'on'
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.scene_avondverlichting
      
- alias: scene avondverlichting off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_avondverlichting_on
    to: 'off'
  - platform: state
    entity_id: group.scene_avondverlichting_off
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_avondverlichting

- alias: scene schoonmaken on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_schoonmaken_on
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_lichtuit
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.scene_schoonmaken
- alias: scene schoonmaken off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_schoonmaken_off
    to: 'off'
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.scene_lichtuit
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_schoonmaken
- alias: scene schoonmaken input_boolean
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_schoonmaken_off
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_lichtuit
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_schoonmaken
- alias: scene koken on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_koken_on
    to: 'on'
  - platform: state
    entity_id: group.scene_koken_off
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_klaar_met_koken
- alias: scene koken off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_koken_off
    to: 'off'
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.scene_klaar_met_koken
      
- alias: scene wassen on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_wassen_on
    to: 'on'
  - platform: state 
    entity_id: group.scene_wassen_off
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_klaar_met_wassen
- alias: scene wassen off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_wassen_off
    to: 'off'
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.scene_klaar_met_wassen
      
- alias: scene welterusten on
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_welterusten_on
    to: 'on'
  condition:
  - condition: state
    entity_id: group.scene_welterusten_off
    state: 'off'
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.scene_welterusten
#  - service: xiaomi_aqara.play_ringtone
#    data_template:
#      ringtone_id: 10004
#      ringtone_vol: 100
#      gw_mac: 78:11:DC:DE:F3:24
- alias: scene welterusten off
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: group.scene_welterusten_off
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.scene_welterusten
      
# Birthday Python Script (this is needed to create the sensor, it will do a day countdown as well as an age indicator)
- alias: Reminder - Refresh date countdown sensors
  initial_state: on
  trigger:
    - platform: time
      at: '00:00:01'
    - platform: homeassistant
      event: start
  action:
    - service: python_script.date_countdown
      data:
        name: Jimmy Schings
        type: birthday
        date: 04/11/1986
    - service: python_script.date_countdown
      data:
        name: Trouwdag
        type: anniversary
        date: 16/06/2017
    - service: python_script.date_countdown
      data:
        name: Stephanie Schings
        type: birthday
        date: 16/06/1989
    - service: python_script.date_countdown
      data:
        name: Tala
        type: birthday
        date: 28/07/2013
    - service: python_script.date_countdown
      data:
        name: Jos Schings
        type: birthday
        date: 12/05/1951
    - service: python_script.date_countdown
      data:
        name: Ad van Dartel
        type: birthday
        date: 20/06/1989
    - service: python_script.date_countdown
      data:
        name: Koos van Duuren
        type: birthday
        date: 02/07/1953
    - service: python_script.date_countdown
      data:
        name: Ralf Vogels
        type: birthday
        date: 20/08/1989
    - service: python_script.date_countdown
      data:
        name: Rick Oosterbosch
        type: birthday
        date: 05/07/1991

# Birthday Notifications
- alias: Tala Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_tala
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Tala is vandaag {{ states.sensor.birthday_jos_schings.attributes.years }} jaar geworden, Verwen haar maar goed vandaag!"
        data:
          push:
            sound: default
            badge: 0

- alias: Jos Schings Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_jos_schings
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Jos Schings is vandaag {{ states.sensor.birthday_jos_schings.attributes.years }} jaar geworden, Feliciteer hem vandaag nog!"
        data:
          push:
            sound: default
            badge: 0

- alias: Wedding Anniversary Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.anniversary_trouwdag
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Trouwdag"
        message: "Vandaag zijn we {{ states.sensor.anniversary_trouwdag.attributes.years }} jaar getrouwd! Proficiat!"
        data:
          push:
            sound: default
            badge: 0

- alias: Stephanie Schings Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_stephanie_schings
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Stephanie Schings is vandaag {{ states.sensor.birthday_stephanie_schings.attributes.years }} jaar geworden!"
        data:
          push:
            sound: default
            badge: 0

- alias: Jimmy Schings Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_jimmy_schings
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Jimmy Schings is vandaag {{ states.sensor.birthday_jimmy_schings.attributes.years }} jaar geworden!"
        data:
          push:
            sound: default
            badge: 0

- alias: Koos van Duuren Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_koos_van_duuren
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Koos van Duuren is vandaag {{ states.sensor.birthday_koos_van_duuren.attributes.years }} jaar geworden, Feliciteer hem vandaag nog!"
        data:
          push:
            sound: default
            badge: 0

- alias: Ad van Dartel Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_koos_van_duuren
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Ad van Dartel is vandaag {{ states.sensor.birthday_ad_van_dartel.attributes.years }} jaar geworden, Feliciteer hem vandaag nog!"
        data:
          push:
            sound: default
            badge: 0

- alias: Ralf Vogels Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_ralf_vogels
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Ralf Vogels is vandaag {{ states.sensor.birthday_ralf_vogels.attributes.years }} jaar geworden, Feliciteer hem vandaag nog!"
        data:
          push:
            sound: default
            badge: 0

- alias: Rick Oosterbosch Birthday Notification
  initial_state: 'true'
  trigger:
    - platform: state
      entity_id: sensor.birthday_rick_oosterbosch
      to: '0'
  action:
    - delay:
        hours: 8
    - service: notify.ios_notifier
      data:
        title: "Verjaardag"
        message: "Rick Oosterbosch is vandaag {{ states.sensor.birthday_rick_oosterbosch.attributes.years }} jaar geworden, Feliciteer hem vandaag nog!"
        data:
          push:
            sound: default
            badge: 0
        
# Vacuum Automations
- id: vacuum_cleaner_error
  alias: Vacuum Cleaner Error
  trigger:
    - platform: state
      entity_id: sensor.vacuum_cleaner_status_sensor
      to: 'Error'
    - platform: state
      entity_id: sensor.vacuum_cleaner_status_sensor
      to: 'In Error'
    - platform: state
      entity_id: sensor.vacuum_cleaner_status_sensor
      to: 'Charging Error'
  action:
    - service: notify.ios_notifier
      data:
        title: 'Roborock S55'
        message: >-
          {% if is_state('sensor.vacuum_cleaner_error_sensor', 'No Error')  %}
            {{states.sensor.vacuum_cleaner_status_sensor.state}}
          {% else %}
            {{states.sensor.vacuum_cleaner_error_sensor.state}}
          {% endif %}
- id: vacuum_cleaner_error_solved
  alias: Vacuum Cleaner Error Solved
  trigger:
    - platform: state
      entity_id: sensor.vacuum_cleaner_error_sensor
      to: 'No Error'
  action:
    - service: notify.ios_notifier
      data:
        title: 'Roborock S55'
        message: Error Resolved
- id: vacuum_cleaner_started
  alias: Vacuum Cleaner Started
  trigger:
    - platform: state
      entity_id: vacuum.xiaomi_vacuum_cleaner
      to: 'cleaning'
    - platform: state
      entity_id: vacuum.xiaomi_vacuum_cleaner
      to: 'returning'
    - platform: state
      entity_id: vacuum.xiaomi_vacuum_cleaner
      to: 'docked'
    - platform: state
      entity_id: vacuum.xiaomi_vacuum_cleaner
      to: 'paused'
    - platform: state
      entity_id: vacuum.xiaomi_vacuum_cleaner
      to: 'idle'
  action:
    - service: notify.ios_notifier
      data:
        title: 'Roborock S55'
        message: >-
          {{states.sensor.vacuum_cleaner_status_sensor.state}}

- id: vacuum_fan_speed_balanced_when_docked
  alias: Vacuum Fan Speed Balanced When Docked
  trigger:
    - platform: state
      entity_id: vacuum.xiaomi_vacuum_cleaner
      to: 'docked'
  action:
   - service: input_select.select_option
     data:
       option: Balanced
       entity_id: input_select.xiaomi_vacuum

- id: vacuum_fan_speed_quiet
  alias: Vacuum Fan Speed Quiet
  trigger:
    - platform: state
      entity_id: input_select.xiaomi_vacuum
      to: 'Quiet'
  action:
   - service: vacuum.set_fan_speed
     data:
       entity_id: vacuum.xiaomi_vacuum_cleaner
       fan_speed: 101

- id: vacuum_fan_speed_balanced
  alias: Vacuum Fan Speed Balanced
  trigger:
    - platform: state
      entity_id: input_select.xiaomi_vacuum
      to: 'Balanced'
  action:
   - service: vacuum.set_fan_speed
     data:
       entity_id: vacuum.xiaomi_vacuum_cleaner
       fan_speed: 102

- id: vacuum_fan_speed_turbo
  alias: Vacuum Fan Speed Turbo
  trigger:
    - platform: state
      entity_id: input_select.xiaomi_vacuum
      to: 'Turbo'
  action:
   - service: vacuum.set_fan_speed
     data:
       entity_id: vacuum.xiaomi_vacuum_cleaner
       fan_speed: 103

- id: vacuum_fan_speed_max
  alias: Vacuum Fan Speed Max
  trigger:
    - platform: state
      entity_id: input_select.xiaomi_vacuum
      to: 'Max'
  action:
   - service: vacuum.set_fan_speed
     data:
       entity_id: vacuum.xiaomi_vacuum_cleaner
       fan_speed: 104

- id: vacuum_fan_speed_mop
  alias: Vacuum Fan Speed Mop
  trigger:
    - platform: state
      entity_id: input_select.xiaomi_vacuum
      to: 'Mop'
  action:
   - service: vacuum.set_fan_speed
     data:
       entity_id: vacuum.xiaomi_vacuum_cleaner
       fan_speed: 105

# deCONZ automations IKEA TRADFRI Remote (deCONZ)
- alias: 'AB Keuken Midden'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_keuken
      event: 1002
  action:
    service: light.toggle
    entity_id: light.keuken
- alias: 'AB Keuken Omhoog'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_keuken
      event: 2002
  action:
    service: light.toggle
    entity_id: light.keukenspots
- alias: 'AB Keuken Omlaag'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_keuken
      event: 3002
  action:
    service: scene.turn_on
    entity_id: scene.wassen
- alias: 'AB Keuken Links'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_keuken
      event: 4002
  action:
    service: scene.turn_on
    entity_id: scene.klaar_met_koken
- alias: 'AB Keuken Rechts'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_keuken
      event: 5002
  action:
    service: scene.turn_on
    entity_id: scene.koken

- alias: 'AB Slaapkamer Center'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer
      event: 1002
  action:
    - service: light.toggle
      entity_id: light.slaapkamer
    - service: light.turn_off
      entity_id:
        - light.slaapkamer_kast
        - light.slaapkamer_bed
- alias: 'AB Slaapkamer Links'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer
      event: 4002
  action:
    service: light.toggle
    entity_id: light.nachtkastje_stephanie
- alias: 'AB Slaapkamer Rechts'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer
      event: 5002
  action:
    service: light.toggle
    entity_id: light.nachtkastje_jimmy
- alias: 'AB Slaapkamer Boven'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer
      event: 2001
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.slaapkamer
        brightness: >
          {% set bri = state_attr('light.slaapkamer', 'brightness') | int %}
          {{ [bri+30, 249] | min }}
- alias: 'AB Slaapkamer Onder'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer
      event: 3001
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.slaapkamer
        brightness: >
          {% set bri = state_attr('light.slaapkamer', 'brightness') | int %}
          {{ [bri-30, 0] | max }}

# Philips Remote Dimmers (deCONZ)

  # Kleine Kamer
- alias: 'AB Kleine Kamer Muur Boven'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_kleine_kamer_muur
      event: 1002
  action:
    service: light.turn_on
    entity_id: 
      - light.kleine_kamer
      - light.officeled
- alias: 'AB Kleine Kamer Muur Boven Long Press'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_kleine_kamer_muur
      event: 1001
  action:
    service: light.turn_on
    entity_id: 
      - light.officeled
- alias: 'AB Kleine Kamer Muur 2nd Button'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_kleine_kamer_muur
      event: 2001
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.kleine_kamer
        brightness: >
          {% set bri = state_attr('light.kleine_kamer', 'brightness') | int %}
          {{ [bri+30, 249] | min }}
- alias: 'AB Kleine Kamer Muur 3d Button'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_kleine_kamer_muur
      event: 3001
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.kleine_kamer
        brightness: >
          {% set bri = state_attr('light.kleine_kamer', 'brightness') | int %}
          {{ [bri-30, 0] | max }}
- alias: 'AB Kleine Kamer Muur Onder'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_kleine_kamer_muur
      event: 4002
  action:
    service: light.turn_off
    entity_id: 
      - light.kleine_kamer
- alias: 'AB Kleine Kamer Muur Onder Long Press'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_kleine_kamer_muur
      event: 4001
  action:
    service: light.turn_off
    entity_id: 
      - light.officeled

  # Slaapkamer
- alias: 'AB Slaapkamer Muur Boven'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer_muur
      event: 1002
  action:
    service: light.turn_on
    entity_id: 
      - light.nachtkastje_jimmy
      - light.nachtkastje_stephanie
      - light.vloerled
      - light.bedled
      - light.slaapkamer_bed
      - light.slaapkamer_kast
- alias: 'AB Slaapkamer Muur Boven Long Press'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer_muur
      event: 1001
  action:
    service: light.turn_on
    entity_id: 
      - light.vloerled
      - light.bedled
- alias: 'AB Slaapkamer Muur 2nd Button'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer_muur
      event: 2002
  action:
    service: light.toggle
    entity_id: 
      - light.slaapkamer_kast
- alias: 'AB Slaapkamer Muur 2nd Button Long Press'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer_muur
      event: 2001
  action:
    service: light.toggle
    entity_id: 
      - light.nachtkastje_stephanie
- alias: 'AB Slaapkamer Muur 3d Button'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer_muur
      event: 3002
  action:
    service: light.toggle
    entity_id: 
      - light.slaapkamer_bed
- alias: 'AB Slaapkamer Muur 3d Button Long Press'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer_muur
      event: 3001
  action:
    service: light.toggle
    entity_id: 
      - light.nachtkastje_jimmy
- alias: 'AB Slaapkamer Muur Onder'
  initial_state: 'on'
  trigger:
    platform: event
    event_type: deconz_event
    event_data:
      id: ab_slaapkamer_muur
      event: 4002
  action:
    service: light.turn_off
    entity_id: 
      - light.nachtkastje_jimmy
      - light.nachtkastje_stephanie
      - light.vloerled
      - light.bedled
      - light.slaapkamer_bed
      - light.slaapkamer_kast
# Grocy Test Automations
- alias: Dishwasher consume tablet clean
  trigger:
    - platform: state
      entity_id: sensor.vaatwasser_status_2
      to: Clean
      for:
        minutes: 5
  action:
    - service: grocy.consume_product
      data:
        product_id: 3
        amount: 1
        spoiled: false
        transaction_type: CONSUME


# Changed/Added in 0.13.0 Below
# Input Select Beautifier
- alias: input select beautifier 1 box-shadow
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.box_shadow_selector
    to: None
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.box_shadow
      option: none
- alias: input select beautifier 2 box-shadow
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.box_shadow_selector
    to: Small
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.box_shadow
      option: 1px 1px 1px 0px rgba(0,0,0,0.75)
- alias: input select beautifier 3 box-shadow
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.box_shadow_selector
    to: Standard
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.box_shadow
      option: 2px 2px 2px 0px rgba(0,0,0,0.75)
- alias: input select beautifier 4 box-shadow
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.box_shadow_selector
    to: Medium
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.box_shadow
      option: 3px 3px 3px 0px rgba(0,0,0,0.75)
- alias: input select beautifier 5 box-shadow
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.box_shadow_selector
    to: Large
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.box_shadow
      option: 5px 5px 5px 0px rgba(0,0,0,0.75)
- alias: input select beautifier 6 box-shadow
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.box_shadow_selector
    to: Huge
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.box_shadow
      option: 7px 7px 7px 0px rgba(0,0,0,0.75)

- alias: input select beautifier 1 border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.border_radius_selector
    to: None
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.border_radius
      option: 0px
- alias: input select beautifier 2 border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.border_radius_selector
    to: Small
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.border_radius
      option: 6px
- alias: input select beautifier 3 border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.border_radius_selector
    to: Standard
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.border_radius
      option: 12px
- alias: input select beautifier 4 border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.border_radius_selector
    to: Large
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.border_radius
      option: 18px

- alias: input select beautifier 1 qam-border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.qam_border_radius_selector
    to: None
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.qam_border_radius
      option: 0px
- alias: input select beautifier 2 qam-border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.qam_border_radius_selector
    to: Small
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.qam_border_radius
      option: 3px
- alias: input select beautifier 3 qam-border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.qam_border_radius_selector
    to: Standard
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.qam_border_radius
      option: 6px
- alias: input select beautifier 4 qam-border-radius
  initial_state: 'true'
  trigger:
  - platform: state
    entity_id: input_select.qam_border_radius_selector
    to: Large
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.qam_border_radius
      option: 9px